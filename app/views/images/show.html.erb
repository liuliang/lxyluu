<script src="/javascripts/tiny_mce/tiny_mce_popup.js" type="text/javascript"></script>
<script type="text/javascript">
  var FileBrowserDialogue = {
    init : function () {
      var win = tinyMCEPopup.getWindowArg("window");
      //就这句关键，IMG_URI应该由服务端生成
      win.document.getElementById(tinyMCEPopup.getWindowArg("input")).value = "<%= @image.avatar.url %>";
      tinyMCEPopup.close();
    }
  };
  tinyMCEPopup.onInit.add(FileBrowserDialogue.init, FileBrowserDialogue);
</script>

<%= image_tag @image.avatar.url %>
